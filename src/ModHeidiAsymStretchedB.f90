module get_gradB_components

  use ModHeidiMain,      ONLY: DipoleFactor
  use ModHeidiInput,     ONLY: StretchingFactorA, StretchingFactorB

contains
  !========================================================================
  subroutine get_dBdx(x, y, z, dBdx)

    implicit none

    real, intent(IN) :: x, y, z
    real, intent(OUT):: dBdx
    ! Local variables used for optimization
    real :: t1,   t2,   t3,   t4,   t5,   t6,   t7,   t8,   t9,   t10
    real :: t13,  t14,  t15,  t16,  t19,  t20,  t21,  t26,  t27,  t28 
    real :: t29,  t30,  t34,  t36,  t39,  t43,  t48,  t49,  t53,  t54
    real :: t58,  t59,  t60,  t64,  t65,  t66,  t69,  t70
    real :: t73,  t74,  t78,  t79,  t82,  t83,  t88,  t92,  t98,  t99
    real :: t104, t108, t110, t113, t117, t118, t123, t131, t134, t135
    real :: t138, t140, t145, t148, t153, t155, t161, t162, t167, t168
    real :: t171, t180, t181, t187, t190, t191, t192, t196, t199, t202
    real :: t205, t206, t207, t212, t217, t223, t224, t227, t230, t238
    real :: t241, t251, t262, t266, t287, t289, t292, t322, t331, t338      
    real :: t352, t355, t382, t387, t391, t422, t429, t433, t440, t443
    real :: t444, t446, t451, t457, t475, t506, t513, t514, t515, t519
    real :: a, b
    !------------------------------------------------------------------------
    a = StretchingFactorA
    b = StretchingFactorB
    
    !\
    ! Calculations are done by Maple using CodeGeneration with optimize flag.
    !/

    t1 = y ** 2
    t2 = t1 ** 2
    t3 = t2 ** 2
    t4 = x ** 2
    t5 = t4 ** 2
    t6 = t3 * t5
    t7 = a ** 2
    t8 = t7 ** 2
    t9 = t8 * a
    t10 = t9 * b
    t13 = z ** 2
    t14 = t13 ** 2
    t15 = t3 * t14
    t16 = a * b
    t19 = t2 * dble(t1)
    t20 = t13 * t19
    t21 = t7 * a
    t26 = t2 * t13
    t27 = t5 * t4
    t28 = t27 * a
    t29 = b ** 2
    t30 = t29 * b
    t34 = t29 ** 2
    t36 = t4 + dble(t1)
    t39 = sqrt(t36 / t4)
    t43 = t3 * t13
    t48 = t19 * t27
    t49 = t8 * t29
    t53 = t14 * t2
    t54 = t39 * t5
    t58 = t5 ** 2
    t59 = t39 * t58
    t60 = t8 * t2
    t64 = t3 * dble(t1)
    t65 = t64 * t4
    t66 = t29 * t39
    t69 = t7 * t29
    t70 = t69 * t39
    t73 = t39 * t27
    t74 = t7 * t19
    t78 = t58 * a
    t79 = b * t2
    t82 = t58 * t14
    t83 = t39 * t7

    t88 = dble(7 * t6 * t10) + dble(24 * t15 * t16) - 0.114D3 * t20 * t5 * t21 * b -  &
         dble(108 * t26 * t28 * t30) - 0.12D2 * dble(t26) * t27 * t34 * t39 - 0.6D1 * &
         t43 * t8 * t39 * t4 + 0.20D2 * t48 * t49 * t39 + 0.48D2 * t53 * t54 * t7 +   &
         0.55D2 * t59 * t60 * t29 + 0.2D1 * t65 * t66 + 0.18D2 * dble(t6) * t70 +     &
         0.48D2 * t73 * t74 * t29 + 0.2D1 * t78 * t79 + 0.8D1 * t82 * t83 + 0.8D1 * dble(t15) * t83

    t92 = t5 * t29
    t98 = t27 * t21
    t99 = t19 * b
    t104 = t5 * a
    t108 = t58 * t4
    t110 = t30 * t1
    t113 = t39 * t108
    t117 = t108 * t21
    t118 = b * dble(t1)
    t123 = a * dble(t30)
    t131 = t58 * t21
    t134 = t2 * t58
    t135 = t21 * dble(t30)

    t138 = 0.4D1 * t48 * t34 * t39 + 0.40D2 * t53 * t92 * t39 + 0.27D2 * t48 *      &
         dble(t10) + 0.54D2 * t98 * t99 + 0.9D1 * dble(t28) * t99 + 0.15D2 * t104 * &
         b * t3 + 0.8D1 * t108 * a * dble(t110) + 0.2D1 * t113 * dble(t1) * t34 +   &
         0.8D1 * t117 * t118 + t59 * t7 * t2 + 0.36D2 * t48 * t123 + 0.39D2 * t58 * &
         t9 * t79 + 0.70D2 * t117 * dble(t110) + 0.34D2 * t131 * t79 + 0.80D2 * t134 * t135

    t140 = t29 * t19
    t145 = t69 * dble(t1)
    t148 = t39 * t4
    t153 = t19 * t14
    t155 = t4 * t29 * t39
    t161 = t39 * t3
    t162 = t13 * t4
    t167 = t39 * t64
    t168 = t4 * t7
    t171 = t13 * dble(t1)
    t180 = t34 * b
    t181 = a * t180
    t187 = t4 * a * b

    t190 = 0.4D1 * t73 * t140 + t59 * t29 * t2 + 0.12D2 * t113 * t145 + 0.48D2 *  &
         t148 * t7 * t3 * t13 + 0.16D2 * t153 * t155 + 0.30D2 * t78 * dble(t30) * &
         t2 - 0.12D2 * t161 * t162 + 0.5D1 * t161 * t92 + 0.4D1 * t167 * t168 -   &
         0.90D2 * t171 * t78 * dble(t30) + 0.6D1 * t59 * t34 * t2 + 0.14D2 *      &
         dble(t6) * t123 + 0.11D2 * t134 * t181 + 0.30D2 * t48 * t135 + 0.138D3 * &
         t43 * t187

    t191 = t39 * t13
    t192 = t5 * t19
    t196 = t27 * t2
    t199 = t58 * dble(t1)
    t202 = t108 * t13
    t205 = t58 * t5
    t206 = t39 * t205
    t207 = t7 * t34
    t212 = t8 * t19
    t217 = t21 * b
    t223 = t39 * t14
    t224 = t19 * t4
    t227 = t108 * t7
    t230 = t2 * t5
    t238 = t5 * t7

    t241 = 0.102D3 * t191 * t192 * t7 - 0.12D2 * t191 * t196 - 0.3D1 *t191 * t199 + &
         0.24D2 * t202 * dble(t16) + 0.15D2 * t206 * t207 + 0.15D2 * t206 * t49 +   &
         0.12D2 * t73 * t212 + 0.8D1 * t59 * t60 - 0.24D2 * t202 * t217 - 0.6D1 *   &
         t191 * t108 * t34 - 0.12D2 * t223 * t224 + 0.12D2 * t191 * t227 - 0.18D2 * &
         t223 * t230 - 0.12D2 * t223 * t27 * dble(t1) - 0.18D2 * t191 * t192 + 0.6D1 * t161 * t238

    t251 = t8 * t7
    t262 = t58 * t8
    t266 = t8 * dble(t1)
    t287 = t34 * t29

    t289 = 0.12D2 * t191 * t108 * t29 + 0.10D2 * t64 * t21 * b * t4 + 0.6D1 * t59 *    &
         t251 * t2 + 0.27D2 * t64 * a * b * t13 - 0.36D2 * t73 * t60 * t13 - 0.24D2 *  & 
         t191 * t262 * dble(t1) + 0.2D1 * t113 * t266 + 0.72D2 * t54 * t140 * t13 +    & 
         0.4D1 * t73 * t74 + 0.8D1 * t82 * t66 - 0.24D2 * t202 * t123 - 0.36D2 * t191 *&
         t227 * t29 + 0.11D2 * t65 * dble(t16) + 0.32D2 * t27 * t14 * t83 * dble(t1) + t206 * t287

    t292 = t3 * t2
    t322 = dble(t1) * t108
    t331 = t7 * dble(t1)

    t338 = -0.3D1 * t223 * t58 + 0.3D1 * t292 * a * b - 0.42D2 * t192 * t123 * t13 + &
         0.88D2 * t153 * t187 + 0.4D1 * t113 * t251 * dble(t1) + 0.9D1 * t64 * t7 *  &
         t191 + 0.8D1 * t54 * t8 * t3 + 0.25D2 * t134 * t207 * t39 + 0.32D2 * t153 * &
         t148 * t7 + 0.102D3 * t191 * t196 * t29 - 0.162D3 * dble(t26) * t98 * b +   &
         0.2D1 * t322 * t287 * t39 - 0.6D1 * t191 * t108 * t8 + 0.38D2 * dble(t6) *  &
         t217 + 0.40D2 * t113 * t331 * t34 + 0.2D1 * t64 * t8 * t148

    t352 = dble(t28) * b
    t355 = t104 * b

    t382 = 0.4D1 * t73 * t251 * t19 - 0.102D3 * t171 * t131 * b + 0.42D2 * t59 * t69 *   &
         t2 + 0.25D2 * t108 * t9 * t118 + 0.270D3 * dble(t26) * t352 + 0.276D3 * t20 *   &
         t355 + 0.60D2 * t191 * t199 * t29 - 0.24D2 * t54 * t212 * t13 + 0.17D2 * t322 * &
         t181 - 0.30D2 * t3 * t4 * t217 * t13 + 0.6D1 * t205 * a * t180 + 0.6D1 * t205 * &
         t9 * b + t206 * t251 + t292 * t7 * t39 + 0.20D2 * t205 * t21 * dble(t30)

    t387 = t14 * dble(t1)
    t391 = t27 * t7
    t422 = t27 * t29

    t429 = -0.3D1 * t167 * t13 + 0.120D3 * t53 * t355 + 0.72D2 * t387 * t352 - 0.144D3 *  &
         t191 * t2 * t391 * t29 - 0.54D2 * t20 * t5 * t70 + 0.18D2 * t43 * t155 +         & 
         0.129D3 * t13 * t58 * dble(t16) * dble(t1) - 0.3D1 * t223 * t3 + 0.50D2 * t113 * &
         t266 * t29 + dble(t6) * t251 * t39 - 0.18D2 * t191 * t199 * t34 + 0.16D2 * t82 * & 
         dble(t16) + 0.57D2 * t191 * t199 * t7 - 0.126D3 * t191 * t58 * t145 + 0.32D2 *   & 
         t387 * t422 * t39 + 0.108D3 * t191 * t196 * t7

    t433 = t36 ** 2
    t440 = dble(t1) * t39 * b
    t443 = t13 * t5
    t444 = t443 * dble(t1)
    t446 = a * t39 * b
    t451 = t13 * t27
    t457 = t39 * b

    t475 = t3 + 0.4D1 * t14 * t5 + 0.4D1 * t98 * t440 + t230 - 0.8D1 * t444 * t446 + 0.4D1 * &
         dble(t28) * t440 - 0.8D1 * t451 * t446 + 0.4D1 * t78 * t39 * dble(t30) + 0.4D1 *    &
         t131 * t457 + 0.6D1 * t391 * dble(t1) * t29 - 0.4D1 * t171 * t92 - 0.4D1 *          &
         dble(t26) * t168 - 0.8D1 * t443 * t331 + 0.2D1 * t224 + 0.2D1 * t422 * dble(t1) +   &
         0.8D1 * t14 * t4 * dble(t1)

    t506 = 0.4D1 * t238 * t2 - 0.4D1 * t451 * t7 + 0.2D1 * t391 * dble(t1) - 0.4D1 * t451 * &
         t29 + 0.4D1 * t53 + 0.9D1 * t451 + t58 * t34 + 0.4D1 * t104 * t457 * t2 + 0.5D1 *  &
         t20 + 0.19D2 * t162 * t2 + 0.23D2 * t444 + 0.2D1 * t168 * t19 + 0.6D1 * t58 * t7 * &
         t29 + t5 * t8 * t2 + 0.2D1 * t92 * t2 + 0.2D1 * t27 * t8 * dble(t1) + t262

    t513 = t238 + t168 * dble(t1) + 0.2D1 * t104 * t457 + t92 + dble(t1) * t4 + t2 + t162 + t171
    t514 = t513 ** 2
    t515 = t514 ** 2
    t519 = sqrt(t433 * t36 * (t475 + t506) / t515 / t513)


    dBdx = abs(DipoleFactor) * (-0.3D1 * (t88 + t138 + t190 + t241 + t289 + t338 + t382 + t429) * &
         t433 * x / t519 / t39 / t515 / t514)


  end subroutine get_dBdx
  !========================================================================
  subroutine get_dBdy(x, y, z, dBdy)

    implicit none

    real, intent(IN) :: x, y, z
    real, intent(OUT):: dBdy
    ! Local variables used for optimization
    real :: t1,   t2,   t3,   t4,   t8,   t9,   t10,  t11,  t12,  t13
    real :: t14,  t15,  t16,  t20,  t21,  t23
    real :: t24,  t27,  t29,  t30,  t34,  t35,  t39,  t40,  t44,  t45
    real :: t46,  t49,  t50,  t54,  t55,  t61,  t62,  t65,  t68,  t69 
    real :: t70,  t73,  t74,  t75,  t78,  t85,  t89,  t92,  t95,  t103
    real :: t107, t114, t116, t122, t129, t130, t135, t140, t147, t148
    real :: t157, t161, t165, t173, t174, t185, t189, t198, t206, t215
    real :: t219, t228, t238, t248, t254, t257, t258, t266, t269, t272
    real :: t274, t275, t278, t296, t309, t336, t342, t356, t359, t367
    real :: t373, t374, t378, t383, t388, t415, t422, t423, t424, t428
    real :: a, b
    !------------------------------------------------------------------------
    a = StretchingFactorA
    b = StretchingFactorB

    !\
    ! Calculations are done by Maple using CodeGeneration with optimize flag.
    !/

    t1 = x ** 2
    t2 = y ** 2
    t3 = t1 + t2
    t4 = t3 ** 2
    t8 = sqrt(t3 / t1)
    t9 = t1 ** 2
    t10 = t9 ** 2
    t11 = t10 * t1
    t12 = t8 * t11
    t13 = a ** 2
    t14 = t13 ** 2
    t15 = t14 * t2
    t16 = b ** 2
    t20 = z ** 2
    t21 = t8 * t20
    t23 = t13 * t2
    t24 = t23 * t16
    t27 = t2 ** 2
    t29 = t9 * t1
    t30 = t29 * t16
    t34 = t8 * t10
    t35 = t14 * t27
    t39 = t29 * a
    t40 = b * t27
    t44 = t10 * a
    t45 = b * t2
    t46 = t45 * t20
    t49 = t10 * t9
    t50 = t16 * b
    t54 = t13 * a
    t55 = t49 * t54
    t61 = t16 ** 2
    t62 = t61 * b
    t65 = t14 * a
    t68 = t20 ** 2
    t69 = t8 * t68
    t70 = t27 ** 2

    t73 = 0.10D2 * t12 * t15 * t16 - 0.36D2 * t21 * t10 * t24 -  &
         0.18D2 * t21 * t27 * t30 * t13 + 0.5D1 * t34 * t35 *    &
         t16 + 0.180D3 * t39 * t40 * t20 + 0.126D3 * t44 * t46 - &
         0.4D1 * t49 * t50 * a - 0.4D1 * t55 * b + 0.10D2 * t55 *&
         t50 + 0.5D1 * t49 * a * t62 + t49 * t65 * b - 0.5D1 *   &
         t69 * t70

    t74 = t27 * t2
    t75 = t8 * t74
    t78 = t9 * t13
    t85 = b * t68
    t89 = a * b
    t92 = t11 * t20
    t95 = t1 * t70
    t103 = t8 * t29
    t107 = t8 * t49

    t114 = -0.4D1 * t75 * t29 + 0.36D2 * t21 * t78 * t74 - 0.20D2 * &
         t69 * t29 * t2 + 0.8D1 * t44 * t85 - 0.4D1 * t11 * t2 *    &
         t89 + 0.33D2 * t92 * t89 - 0.39D2 * t21 * t95 - 0.6D1 *    &
         t21 * t11 * t61 - 0.6D1 * t34 * t35 - 0.4D1 * t103 * t14 * &
         t74 + 0.5D1 * t107 * t14 * t16 + 0.10D2 * t107 * t13 * t61

    t116 = t11 * t13
    t122 = t10 * t2
    t129 = t74 * t54
    t130 = b * t29
    t135 = t27 * t54
    t140 = b * t9
    t147 = t74 * a
    t148 = t50 * t29

    t157 = 0.9D1 * t21 * t116 + 0.24D2 * t21 * t11 * t16 - 0.66D2 * &
         t21 * t122 + 0.3D1 * t27 * t65 * b * t10 - 0.10D2 * t129 * &
         t130 + t74 * t65 * t130 + 0.10D2 * t135 * t50 * t10 -      &
         0.2D1 * t70 * t54 * t140 + 0.5D1 * t2 * a * t62 * t11 +    &
         0.2D1 * t147 * t148 + 0.10D2 * t12 * t23 * t61 - 0.18D2 *  &
         t135 * t130 * t20

    t161 = t27 * a
    t165 = t140 * t20
    t173 = t70 * a
    t174 = b * t1
    t185 = t50 * t20
    t189 = t10 * t54

    t198 = 0.24D2 * t39 * t85 * t2 - 0.18D2 * t161 * t148 * t20 - &
         0.6D1 * t129 * t165 + 0.114D3 * t147 * t165 + 0.24D2 *   &
         t161 * t140 * t68 + 0.27D2 * t173 * t174 * t20 + 0.8D1 * &
         t147 * t174 * t68 - 0.6D1 * t34 * t13 * t27 * t16 -      &
         0.36D2 * t44 * t185 * t2 - 0.18D2 * t189 * t46 + 0.66D2 *&
         t21 * t122 * t16 + 0.36D2 * t21 * t122 * t13

    t206 = t29 * t13
    t215 = t70 * t2
    t219 = t27 * t9
    t228 = t8 * t9

    t238 = -0.15D2 * t44 * t40 - 0.21D2 * t39 * b * t74 + 0.54D2 * &
         t21 * t206 * t27 - 0.18D2 * t21 * t116 * t16 - 0.13D2 *   &
         t173 * t140 - 0.3D1 * t215 * a * t174 - 0.30D2 * t69 *    &
         t219 + 0.8D1 * t10 * t68 * t8 * t16 - 0.4D1 * t12 * t15 - &
         0.8D1 * t228 * t13 * t70 - t228 * t14 * t70 - 0.2D1 *     &
         t8 * t1 * t13 * t215

    t248 = t2 * t16
    t254 = t74 * t1
    t257 = t8 * t27
    t258 = t10 * t13
    t266 = t20 * t29
    t269 = t9 * t20

    t272 = -0.4D1 * t103 * t16 * t74 + t34 * t61 * t27 - t228 * t16 * &
         t70 - 0.2D1 * t12 * t23 - 0.2D1 * t12 * t248 - 0.6D1 * t107 *&
         t16 * t13 - 0.20D2 * t69 * t254 - 0.8D1 * t257 * t258 -      &
         0.12D2 * t75 * t206 - 0.5D1 * t257 * t10 * t16 - 0.114D3 *   &
         t257 * t266 - 0.96D2 * t75 * t269

    t274 = t11 * t54
    t275 = t50 * t2
    t278 = t11 * a
    t296 = t9 * t16

    t309 = 0.20D2 * t274 * t275 - 0.6D1 * t278 * t275 - 0.18D2 * t278 *  &
         t185 + 0.3D1 * t11 * t65 * t45 - 0.14D2 * t274 * t45 - 0.18D2 * &
         t189 * t40 - 0.6D1 * t274 * b * t20 + 0.16D2 * t30 * t69 * t2 + &
         0.8D1 * t296 * t69 * t27 - 0.6D1 * t21 * t122 * t61 + 0.60D2 *  &
         t21 * t27 * t29 * t16 - t8 * t70 * t27


    t336 = -0.12D2 * t12 * t24 + 0.18D2 * t21 * t74 * t9 * t16 + 0.9D1 * &
         t21 * t95 * t13 - 0.6D1 * t8 * t70 * t9 - 0.4D1 * t8 * t215 *   &
         t1 + t107 * t61 * t16 - 0.5D1 * t69 * t10 - 0.6D1 * t21 * t215 -&
         t34 * t27 - t107 * t61 - t107 * t14 - 0.15D2 * t92 * t8

    t342 = t8 * b
    t356 = a * t8 * b
    t359 = t342 * t2
    t367 = t269 * t2

    t373 = 0.4D1 * t189 * t342 + t70 + 0.4D1 * t68 * t27 + t219 + 0.2D1 * &
         t254 + t10 * t61 + t10 * t14 + 0.4D1 * t68 * t9 + 0.4D1 * t44 *  &
         t8 * t50 - 0.8D1 * t266 * t356 + 0.4D1 * t39 * t359 + 0.5D1 *    &
         t20 * t74 + 0.4D1 * t29 * t54 * t359 - 0.8D1 * t367 * t356 +     &
         0.9D1 * t266 - 0.8D1 * t269 * t23

    t374 = t20 * t2
    t378 = t1 * t13
    t383 = t9 * a
    t388 = t20 * t1

    t415 = -0.4D1 * t374 * t296 - 0.4D1 * t20 * t27 * t378 + 0.6D1 * t206 *&
         t248 + 0.4D1 * t383 * t342 * t27 + 0.23D2 * t367 + 0.19D2 * t388 *&
         t27 + 0.8D1 * t68 * t1 * t2 - 0.4D1 * t266 * t13 - 0.4D1 * t266 * &
         t16 + 0.2D1 * t29 * t14 * t2 + 0.6D1 * t258 * t16 + 0.2D1 * t206 *&
         t2 + 0.4D1 * t78 * t27 + t9 * t14 * t27 + 0.2D1 * t378 * t74 +    &
         0.2D1 * t30 * t2 + 0.2D1 * t296 * t27

    t422 = t78 + t378 * t2 + 0.2D1 * t383 * t342 + t296 + t2 * t1 + t27 + &
         t388 + t374
    t423 = t422 ** 2
    t424 = t423 ** 2
    t428 = sqrt(t4 * t3 * (t373 + t415) / t424 / t422)

    dBdy = abs(DipoleFactor) *(0.3D1 * t4 * y * (t73 + t114 + t157 + t198 + t238 + t272 + t309 + t336) &
         / t428 / t424 / t423 / t8)

  end subroutine get_dBdy
  !========================================================================
  subroutine get_dBdz(x, y, z, dBdz)

    implicit none

    real, intent(IN) :: x, y, z
    real, intent(OUT):: dBdz
    ! Local variables used for optimization
    real :: t1,   t2,   t3,   t4,   t5,   t7,   t8,   t9,   t10,  t11
    real :: t14,  t15,  t16,  t19,  t20,  t22,  t23,  t25,  t26,  t28   
    real :: t29,  t31,  t32,  t35,  t38,  t39,  t40,  t42,  t45,  t48
    real :: t55,  t56,  t62,  t66,  t67,  t73,  t76,  t77,  t80,  t83
    real :: t86,  t89,  t91,  t94,  t98,  t102, t103, t106, t112, t113
    real :: t118, t121, t124, t125, t128, t136, t137, t140, t161, t164
    real :: t191, t192, t201, t218, t226, t233, t234, t235, t239
    real :: a, b
    !------------------------------------------------------------------------
    a = StretchingFactorA
    b = StretchingFactorB

    !\
    ! Calculations are done by Maple using CodeGeneration with optimize flag.
    !/

    t1 = x ** 2
    t2 = y ** 2
    t3 = t1 + t2
    t4 = t3 ** 2
    t5 = t4 * t3
    t7 = t1 ** 2
    t8 = z ** 2
    t9 = t7 * t8
    t10 = t2 ** 2
    t11 = t9 * t10
    t14 = sqrt(t3 / t1)
    t15 = a * t14
    t16 = t15 * b
    t19 = t7 * t1
    t20 = t19 * t10
    t22 = t10 * t2
    t23 = t7 * t22
    t25 = t10 ** 2
    t26 = t1 * t25
    t28 = t7 ** 2
    t29 = t28 * t2
    t31 = t28 * t1
    t32 = b ** 2
    t35 = t28 * t8
    t38 = a ** 2
    t39 = t38 * a
    t40 = t28 * t39
    t42 = t2 * t14 * b
    t45 = t38 ** 2
    t48 = t7 * t38

    t55 = -0.16D2 * t11 * t16 - 0.9D1 * t20 - 0.9D1 * t23 - 0.3D1 * &
         t26 - 0.3D1 * t29 - 0.3D1 * t31 * t32 - 0.16D2 * t35 *     &
         t16 + 0.24D2 * t40 * t42 + 0.3D1 * t23 * t45 + 0.6D1 *     &
         t48 * t22 + 0.3D1 * t26 * t38 + 0.3D1 * t23 * t32

    t56 = t32 ** 2
    t62 = t19 * t32
    t66 = t19 * t8
    t67 = t66 * t2
    t73 = t1 * t8
    t76 = t8 ** 2
    t77 = t7 * t76
    t80 = t1 * t76
    t83 = t28 * t38
    t86 = t31 * t38

    t89 = 0.3D1 * t29 * t56 - 0.3D1 * t28 * t32 * t2 + 0.3D1 * t62 * &
         t10 + 0.48D2 * t11 + 0.40D2 * t67 - 0.8D1 * t35 * t32 -     &
         0.8D1 * t35 * t38 + 0.24D2 * t73 * t22 + 0.12D2 * t77 * t2 +&
         0.12D2 * t80 * t10 - 0.6D1 * t83 * t2 + 0.18D2 * t86 * t32

    t91 = t28 * t45
    t94 = t19 * t45
    t98 = t14 * b
    t102 = t19 * a
    t103 = t98 * t10
    t106 = t2 * t32
    t112 = t8 * t10
    t113 = t7 * t32
    t118 = t31 * a
    t121 = t28 * a
    t124 = t8 * t22
    t125 = t1 * t38

    t128 = 0.9D1 * t91 * t2 + 0.9D1 * t94 * t10 + 0.12D2 * t31 * t39 * &
         t98 - 0.3D1 * t86 + 0.6D1 * t102 * t103 - 0.16D2 * t66 *      &
         t106 - 0.24D2 * t9 * t10 * t38 - 0.8D1 * t112 * t113 + 0.3D1 *&
         t31 * t45 - 0.6D1 * t118 * t98 - 0.6D1 * t121 * t42 - 0.8D1 * &
         t124 * t125

    t136 = t32 * b
    t137 = t14 * t136
    t140 = t38 * t2

    t161 = 0.36D2 * t83 * t106 + 0.18D2 * t20 * t38 * t32 + 0.6D1 * &
         t23 * t16 + 0.12D2 * t118 * t137 - 0.24D2 * t66 * t140 +   &
         0.12D2 * t29 * t15 * t136 - 0.32D2 * t67 * t16 + 0.12D2 *  &
         t20 * t39 * t14 * b + 0.4D1 * t19 * t76 + 0.4D1 * t8 *     &
         t25 + 0.4D1 * t76 * t22 + 0.12D2 * t35 + 0.3D1 * t31 * t56

    t164 = t7 * a

    t191 = 0.4D1 * t164 * t103 + 0.9D1 * t66 + 0.5D1 * t124 + 0.4D1 * &
         t77 + 0.4D1 * t76 * t10 + t91 + t28 * t56 + t10 * t7 +       &
         0.2D1 * t22 * t1 + 0.4D1 * t19 * t39 * t42 - 0.8D1 * t66 *   &
         t16 + 0.8D1 * t80 * t2 - 0.4D1 * t66 * t38 - 0.4D1 * t66 *   &
         t32 + 0.2D1 * t94 * t2 + 0.6D1 * t83 * t32

    t192 = t19 * t38
    t201 = t8 * t2
    t218 = t9 * t2

    t226 = 0.2D1 * t192 * t2 + 0.4D1 * t48 * t10 - 0.8D1 * t9 * t140 - &
         0.4D1 * t112 * t125 - 0.4D1 * t201 * t113 + 0.6D1 * t192 *    &
         t106 + 0.4D1 * t40 * t98 + 0.4D1 * t121 * t137 + t7 * t45 *   &
         t10 + 0.2D1 * t125 * t22 + 0.2D1 * t62 * t2 + 0.2D1 * t113 *  &
         t10 + 0.23D2 * t218 + 0.19D2 * t73 * t10 - 0.8D1 * t218 * t16 &
         + 0.4D1 * t102 * t42 + t25

    t233 = t48 + t125 * t2 + 0.2D1 * t164 * t98 + t113 + t2 * t1 + t10 &
         + t73 + t201
    t234 = t233 ** 2
    t235 = t234 ** 2
    t239 = sqrt(t5 * (t191 + t226) / t235 / t233)

    dBdz = abs(DipoleFactor) * (-0.3D1 * t5 * z * (t55 + t89 + t128 + t161) / t239 / t235 / t234)

  end subroutine get_dBdz

  !========================================================================
  subroutine get_GradB2CrossB_x(x, y, z, Vx)

    implicit none

    real, intent(IN) :: x, y, z
    real, intent(OUT):: Vx
    ! Local variables used for optimization
    real :: t1,   t2,   t3,   t4,   t9,   t10,  t11,  t12,  t13,  t14
    real :: t15,  t16,  t17,  t18,  t21,  t22,  t24,  t26,  t27,  t28
    real :: t31,  t32,  t35,  t36,  t37,  t38,  t42,  t46,  t47,  t48
    real :: t51,  t52,  t53,  t56,  t57,  t60,  t61,  t64,  t65,  t66
    real :: t68,  t72,  t75,  t76,  t77,  t81,  t82,  t85,  t86,  t87
    real :: t91,  t92,  t96,  t102, t108, t112, t116, t117, t118, t122
    real :: t126, t127, t134, t138, t145, t147, t154, t155, t159, t160
    real :: t161, t168, t169, t172, t175, t176, t179, t181, t189, t193
    real :: t196, t198, t201, t202, t203, t210, t214, t221, t222, t231
    real :: t237, t240, t249, t259, t265, t266, t267, t270, t277, t283
    real :: t290, t294, t295, t297, t303, t316, t319, t322, t323, t326
    real :: t327, t333, t345, t347, t351, t352, t355, t381, t387, t391
    real :: t394, t408, t418, t430, t431, t441, t444, t463, t466, t469
    real :: t477, t483, t493, t496, t499, t500, t506, t511, t516, t519
    real :: t525, t526, t538, t540, t545, t548, t568, t574, t582, t592
    real :: t598, t601, t619, t623, t628, t633, t662, t665, t674, t685
    real :: t686, t708, t712, t740, t752, t761, t798, t813, t814, t815
    real :: t816, t821
    real :: a, b
    !------------------------------------------------------------------------
    a = StretchingFactorA
    b = StretchingFactorB
    
    !\
    ! Calculations are done by Maple using CodeGeneration with optimize flag.
    !/

    t1 = x ** 2
    t2 = y ** 2
    t3 = t1 + t2
    t4 = t3 ** 2
    t9 = sqrt(t3 / t1)
    t10 = t1 ** 2
    t11 = t10 ** 2
    t12 = t11 * t1
    t13 = t9 * t12
    t14 = a ** 2
    t15 = t14 ** 2
    t16 = t2 ** 2
    t17 = t16 * t2
    t18 = t15 * t17
    t21 = z ** 2
    t22 = t21 ** 2
    t24 = t10 * t1
    t26 = b ** 2
    t27 = t26 * t9
    t28 = t27 * t14
    t31 = t22 * t9
    t32 = t11 * t16
    t35 = t21 * t9
    t36 = t11 * t10
    t37 = t36 * t2
    t38 = t26 ** 2
    t42 = t11 * t24
    t46 = t16 ** 2
    t47 = t46 * t16
    t48 = t1 * t47
    t51 = t17 * t12
    t52 = t38 * t9
    t53 = t52 * t14
    t56 = t46 * t2
    t57 = t56 * t1
    t60 = t36 * t16
    t61 = a * b
    t64 = t11 ** 2
    t65 = t64 * t9
    t66 = t38 * t26
    t68 = t38 * b
    t72 = t9 * t47
    t75 = t2 * a
    t76 = t26 * b
    t77 = t76 * t12
    t81 = t12 * t22
    t82 = t61 * t2

    t85 = -0.30D2 * t13 * t18 + 0.60D2 * t17 * t22 * t24 * t28 - 0.85D2 * &
         t31 * t32 + 0.35D2 * t35 * t37 * t38 - 0.18D2 * t42 * t2 * t28 - &
         0.26D2 * t35 * t48 + 0.15D2 * t51 * t53 + t31 * t57 * t14 -      &
         0.6D1 * t60 * t61 - t65 * t66 - 0.6D1 * t64 * t68 * a - 0.10D2 * &
         t72 * t10 + 0.180D3 * t75 * t77 * t22 - 0.120D3 * t81 * t82

    t86 = t12 * a
    t87 = b * t16
    t91 = t22 * t21
    t92 = t91 * t9
    t96 = t36 * t21
    t102 = t18 * t26
    t108 = t12 * t14
    t112 = t12 * t16
    t116 = t14 * a
    t117 = t42 * t116
    t118 = b * t2
    t122 = t116 * b
    t126 = t16 * t116
    t127 = t77 * t21
    t134 = t11 * t21
    t138 = t61 * t17

    t145 = -0.73D2 * t86 * t87 * t21 - 0.10D2 * t92 * t11 * t2 - 0.49D2 * &
         t96 * t82 - 0.10D2 * t92 * t1 * t46 - 0.15D2 * t13 * t102 -      &
         0.114D3 * t31 * t32 * t26 + 0.5D1 * t31 * t108 * t2 + 0.19D2 *   &
         t35 * t112 * t38 - 0.12D2 * t117 * t118 + 0.166D3 * t12 * t21 *  &
         t122 * t16 - 0.240D3 * t126 * t127 - 0.80D2 * t75 * t68 * t36 *  &
         t21 + 0.134D3 * t134 * t122 * t17 - 0.42D2 * t134 * t138 +       &
         0.2D1 * t24 * t21 * t61 * t46

    t147 = t11 * t17
    t154 = t17 * a
    t155 = t76 * t11
    t159 = t46 * t24
    t160 = t15 * a
    t161 = t160 * b
    t168 = t9 * t56
    t169 = t24 * t14
    t172 = t64 * t160
    t175 = t46 * t17
    t176 = t9 * t175
    t179 = t11 * t26
    t181 = t22 * t16
    t189 = t9 * t36
    t193 = t42 * t14
    t196 = t36 * t14
    t198 = t10 * t14

    t201 = -0.80D2 * t35 * t147 + 0.20D2 * t35 * t12 * t15 * t16 + 0.68D2 * &
         t154 * t155 * t21 - 0.8D1 * t159 * t161 * t21 + 0.17D2 * t35 *     &
         t42 * t38 - 0.30D2 * t168 * t169 + 0.21D2 * t172 * t76 - 0.4D1 *   &
         t176 * t21 + 0.180D3 * t179 * t9 * t181 * t14 - 0.3D1 * t47 * t15 *&
         t9 * t10 + 0.20D2 * t189 * t38 * t22 - 0.6D1 * t35 * t193 + t31 *  &
         t196 - 0.15D2 * t72 * t198

    t202 = t42 * t21
    t203 = a * t76
    t210 = t17 * t24
    t214 = t38 * t15
    t221 = t9 * t17
    t222 = t12 * t26
    t231 = t46 ** 2
    t237 = t38 * t76
    t240 = t15 * t14

    t249 = 0.53D2 * t202 * t203 - 0.12D2 * t202 * t61 - 0.34D2 * t35 * t112 + &
         0.60D2 * t210 * t203 * t22 + 0.35D2 * t189 * t214 * t16 + 0.10D2 *   &
         t31 * t210 * t14 - 0.81D2 * t221 * t222 * t14 + 0.180D3 * t81 * t14 *&
         t26 * t2 * t9 - t9 * t231 - 0.32D2 * t35 * t196 * t2 + 0.7D1 * t64 * &
         a * t237 - t65 * t240 - 0.10D2 * t168 * t24 - 0.5D1 * t176 * t1 +    &
         0.35D2 * t64 * t116 * t68

    t259 = t9 * t46
    t265 = t9 * t42
    t266 = t38 * t2
    t267 = t266 * t14
    t270 = t46 * t10
    t277 = t134 * t9
    t283 = t35 * t36
    t290 = t11 * a

    t294 = -0.6D1 * t31 * t36 - 0.6D1 * t172 * b - 0.2D1 * t92 * t12 - t13 * &
         t17 - 0.5D1 * t259 * t11 + 0.2D1 * t35 * t42 * t15 - 0.15D2 * t265 *&
         t267 - 0.9D1 * t31 * t270 * t26 + 0.20D2 * t35 * t147 * t15 -       &
         0.40D2 * t102 * t277 + 0.10D2 * t35 * t159 * t15 + 0.180D3 * t283 * &
         t14 * t2 * t26 - 0.100D3 * t35 * t159 - 0.56D2 * t290 * b * t46

    t295 = t15 * t116
    t297 = b * t12
    t303 = t10 * t56
    t316 = t36 * t116
    t319 = t17 * t160
    t322 = t16 * t160
    t323 = t76 * t36
    t326 = t46 * t116
    t327 = b * t11
    t333 = t66 * t14

    t345 = 0.4D1 * t17 * t295 * t297 + 0.22D2 * t35 * t159 * t26 - 0.70D2 * &
         t35 * t303 - 0.80D2 * t31 * t270 + 0.6D1 * t16 * t295 * b * t36 -  &
         0.16D2 * t46 * t91 * t61 * t1 - 0.57D2 * t316 * t87 - 0.42D2 *     &
         t319 * t297 + 0.63D2 * t322 * t323 - 0.102D3 * t326 * t327 -       &
         0.18D2 * t46 * t160 * t327 + 0.21D2 * t265 * t333 * t2 + 0.23D2 *  &
         t202 * t122 + 0.120D3 * t126 * t327 * t22 + 0.7D1 * t75 * t237 * t42

    t347 = t24 * t26
    t351 = t56 * t116
    t352 = b * t24
    t355 = t240 * t17
    t381 = t14 * t16
    t387 = b * t10
    t391 = t122 * t2

    t394 = -0.48D2 * t347 * t92 * t16 - 0.48D2 * t351 * t352 + 0.7D1 * t13 * &
         t355 * t26 + 0.80D2 * t17 * t116 * t352 * t22 - 0.3D1 * t265 * t15 *&
         t2 - 0.45D2 * t265 * t15 * t26 * t2 - 0.16D2 * t35 * t303 * t14 -   &
         0.3D1 * t265 * t266 + 0.51D2 * t326 * t352 * t21 - 0.70D2 * t35 *   &
         t108 * t16 - 0.3D1 * t189 * t381 - 0.3D1 * t189 * t26 * t16 -       &
         0.64D2 * t154 * t387 * t91 + 0.99D2 * t96 * t391

    t408 = t64 * t15
    t418 = t36 * t26
    t430 = t47 * a
    t431 = b * t21
    t441 = t36 * t22

    t444 = 0.9D1 * t35 * t46 * t169 * t26 - 0.56D2 * t31 * t210 * t26 -     &
         0.48D2 * t322 * t297 * t21 - 0.32D2 * t319 * t327 * t21 - 0.15D2 * &
         t408 * t27 - 0.15D2 * t64 * t38 * t14 * t9 + 0.5D1 * t35 * t303 *  &
         t26 - 0.11D2 * t35 * t418 * t2 - 0.15D2 * t168 * t24 * t15 -       &
         0.80D2 * t35 * t193 * t38 - 0.31D2 * t31 * t57 + 0.3D1 * t430 *    &
         t431 * t1 - 0.5D1 * t9 * t11 * t240 * t46 - 0.29D2 * t31 * t418 -  &
         0.28D2 * t441 * t61

    t463 = b * t17
    t466 = a * t68
    t469 = t12 * t38
    t477 = t16 * a
    t483 = t38 * t16

    t493 = -0.50D2 * t35 * t159 * t14 - 0.5D1 * t31 * t47 - 0.12D2 * t42 * &
         t76 * t75 - 0.5D1 * t175 * a * b * t1 + 0.2D1 * t35 * t303 * t15 -&
         0.29D2 * t86 * t463 + 0.9D1 * t51 * t466 + 0.40D2 * t469 * t31 *  &
         t2 + 0.20D2 * t181 * t11 * t38 * t9 + 0.180D3 * t477 * t155 *     &
         t22 + 0.60D2 * t441 * t28 + 0.15D2 * t196 * t483 * t9 + 0.8D1 *   &
         t35 * t222 * t16 - 0.40D2 * t112 * t466 * t21

    t496 = t56 * a
    t499 = t46 * t11
    t500 = t116 * t76
    t506 = t56 * t24
    t511 = t46 * a
    t516 = t387 * t21
    t519 = t15 * t16
    t525 = t36 * a
    t526 = t76 * t16

    t538 = -0.26D2 * t430 * t387 - 0.54D2 * t496 * t352 + 0.10D2 * t499 * &
         t500 + 0.21D2 * t51 * t160 * t76 - 0.3D1 * t506 * t161 + t499 *  &
         t295 * b + 0.5D1 * t511 * t76 * t24 * t21 + 0.11D2 * t496 *      &
         t516 - 0.15D2 * t189 * t519 - 0.30D2 * t259 * t11 * t15 -        &
         0.39D2 * t525 * t526 - 0.15D2 * t221 * t108 + 0.60D2 * t441 *    &
         t203 + 0.20D2 * t441 * t122 - 0.20D2 * t92 * t10 * t17

    t540 = t12 * t116
    t545 = t240 * t16
    t548 = t240 * t2
    t568 = t36 * t160
    t574 = t66 * t21

    t582 = -0.108D3 * t540 * t463 + t35 * t147 * t38 - 0.10D2 * t189 *   &
         t545 - 0.5D1 * t265 * t548 + 0.7D1 * t65 * t240 * t26 - 0.6D1 * &
         t35 * t42 * t26 - 0.3D1 * t175 * t14 * t9 * t1 + 0.10D2 * t35 * &
         t36 * t15 * t2 - 0.80D2 * t35 * t147 * t14 - 0.32D2 * t568 *    &
         t431 * t2 + 0.21D2 * t65 * t333 - 0.8D1 * t265 * t574 - 0.10D2 *&
         t13 * t355 + 0.2D1 * t189 * t66 * t16

    t592 = t38 ** 2
    t598 = t47 * t10
    t601 = t519 * t26
    t619 = t12 * t2

    t623 = t265 * t66 * t2 - 0.6D1 * t35 * t37 - 0.20D2 * t64 * t76 *     &
         t116 + t64 * t295 * b + t65 * t592 - 0.2D1 * t92 * t56 - 0.16D2 *&
         t222 * t92 - 0.2D1 * t598 * t27 - 0.45D2 * t189 * t601 - 0.60D2 *&
         t511 * t387 * t22 - 0.6D1 * t189 * t483 + 0.164D3 * t96 * t203 * &
         t2 + 0.10D2 * t31 * t32 * t14 + 0.84D2 * t277 * t17 * t14 * t26 -&
         0.96D2 * t31 * t619 * t26

    t628 = t35 * t12
    t633 = t10 * t26
    t662 = t76 * t17

    t665 = -t506 * t240 * t9 + 0.198D3 * t628 * t381 * t26 - 0.16D2 * t17 * &
         t91 * t633 * t9 - 0.3D1 * t221 * t469 - 0.45D2 * t259 * t179 *     &
         t14 - 0.2D1 * t35 * t48 * t14 - 0.11D2 * t221 * t222 + 0.30D2 *    &
         t35 * t147 * t26 + 0.35D2 * t408 * t52 - 0.9D1 * t168 * t347 -     &
         0.16D2 * t12 * t91 * t61 - 0.15D2 * t259 * t179 + 0.12D2 * t525 *  &
         t68 * t16 + 0.10D2 * t540 * t662

    t674 = t42 * t160
    t685 = t42 * a
    t686 = t68 * t2

    t708 = -0.30D2 * t316 * t526 - 0.80D2 * t16 * t21 * t12 * t53 - 0.48D2 * &
         t568 * t87 - 0.27D2 * t674 * t118 + 0.4D1 * t42 * t295 * t118 -     &
         0.8D1 * t674 * t431 + 0.21D2 * t189 * t545 * t26 - 0.3D1 * t685 *   &
         t686 + 0.70D2 * t117 * t686 - 0.40D2 * t685 * t68 * t21 - 0.21D2 *  &
         t290 * t76 * t46 - 0.8D1 * t189 * t574 * t2 - 0.45D2 * t86 * t662 - &
         0.48D2 * t179 * t92 * t2 + 0.35D2 * t60 * t116 * t68

    t712 = t76 * t2
    t740 = t61 * t16

    t752 = -0.3D1 * t506 * t203 - 0.50D2 * t117 * t712 + 0.63D2 * t674 *  &
         t712 - 0.80D2 * t117 * t76 * t21 - 0.9D1 * t598 * t122 + 0.5D1 * &
         t31 * t270 * t14 + 0.70D2 * t265 * t214 * t2 - 0.9D1 * t506 *    &
         t28 - 0.8D1 * t496 * b * t22 * t1 + 0.7D1 * t351 * t516 -        &
         0.64D2 * t11 * t91 * t82 - 0.96D2 * t24 * t91 * t740 - 0.200D3 * &
         t11 * t22 * t740 - 0.160D3 * t24 * t22 * t138 - 0.80D2 * t147 *  &
         t500 * t21

    t761 = t21 * t2

    t798 = -0.120D3 * t601 * t628 + 0.57D2 * t35 * t193 * t26 + 0.80D2 *  &
         t81 * t391 - 0.120D3 * t189 * t15 * t761 * t26 - 0.160D3 * t267 *&
         t283 - 0.63D2 * t9 * t16 * t196 * t26 + 0.21D2 * t265 * t548 *   &
         t26 - 0.40D2 * t265 * t15 * t21 * t26 - 0.35D2 * t31 * t619 -    &
         0.20D2 * t92 * t24 * t16 - 0.110D3 * t31 * t210 - 0.30D2 * t259 *&
         t11 * t14 - 0.240D3 * t2 * t116 * t323 * t21 + 0.20D2 * t46 *    &
         t22 * t122 * t10 + 0.174D3 * t477 * t127

    t813 = t198 + t1 * t14 * t2 + 0.2D1 * t10 * a * t9 * b + t633 + t2 * &
         t1 + t16 + t21 * t1 + t761

    t814 = t813 ** 2
    t815 = t814 ** 2
    t816 = t815 ** 2
    t821 = sqrt(t813 / t3)

    Vx =(-0.3D1 * t4 * t3 * y * (t85 + t145 + t201 + t249 + t294 + t345 + &
         t394 + t444 + t493 + t538 + t582 + t623 + t665 + t708 + t752 +    &
         t798) / t9 / t816 / t821)



  end subroutine get_GradB2CrossB_x
  !========================================================================
  subroutine get_GradB2CrossB_y(x, y, z, Vy)

    implicit none

    real, intent(IN) :: x, y, z
    real, intent(OUT):: Vy
    ! Local variables used for optimization
    real :: t1,   t2,   t3,   t4,   t7,   t8,   t9,   t10,  t11,  t12
    real :: t13,  t14,  t15,  t16,  t21,  t22,  t23,  t24,  t25,  t26
    real :: t27,  t31,  t32,  t33,  t34,  t35,  t38,  t39,  t42,  t43
    real :: t47,  t51,  t52,  t56,  t57,  t60,  t61,  t65,  t66,  t70
    real :: t73,  t74,  t75,  t78,  t79,  t83,  t84,  t85,  t92,  t93
    real :: t99,  t100, t103, t106, t108, t109, t114, t118, t125, t126
    real :: t127, t130, t134, t135, t136, t139, t145, t155, t156, t161
    real :: t162, t165, t168, t169, t172, t175, t178, t179, t182, t186
    real :: t192, t199, t202, t203, t206, t207, t210, t214, t217, t220
    real :: t221, t224, t225, t228, t229, t232, t233, t238, t239, t244
    real :: t246, t249, t262, t263, t266, t270, t271, t275, t281, t283
    real :: t286, t289, t292, t293, t296, t299, t302, t305, t306, t309
    real :: t310, t313, t315, t318, t319, t325, t328, t332, t339, t340
    real :: t343, t348, t360, t361, t364, t367, t372, t378, t379, t387
    real :: t392, t398, t402, t408, t412, t414, t418, t419, t423, t442
    real :: t449, t450, t453, t454, t457, t467, t475, t481, t491, t495
    real :: t501, t506, t507, t510, t516, t522, t529, t562, t577, t578
    real :: t598, t601, t604, t617, t622, t631, t645, t662, t666, t667
    real :: t676, t679, t682, t693, t720, t722, t733, t744, t751, t784
    real :: t800, t810, t841, t858, t888, t894, t922, t947, t963, t964
    real :: t965, t966, t971
    real :: a, b
    !------------------------------------------------------------------------
    a = StretchingFactorA
    b = StretchingFactorB
    
    !\
    ! Calculations are done by Maple using CodeGeneration with optimize flag.
    !/

    t1 = x ** 2
    t2 = y ** 2
    t3 = t1 + t2
    t4 = t3 ** 2
    t7 = t2 ** 2
    t8 = t7 ** 2
    t9 = t8 * t2
    t10 = t1 ** 2
    t11 = t9 * t10
    t12 = a ** 2
    t13 = t12 * a
    t14 = t13 * b
    t15 = z ** 2
    t16 = t14 * t15
    t21 = sqrt(t3 / t1)
    t22 = t15 * t21
    t23 = t10 ** 2
    t24 = t23 * t10
    t25 = t24 * t2
    t26 = b ** 2
    t27 = t26 ** 2
    t31 = t15 ** 2
    t32 = t31 * t15
    t33 = t32 * t23
    t34 = a * b
    t35 = t34 * t2
    t38 = t23 * t1
    t39 = t38 * t7
    t42 = t31 * t21
    t43 = t10 * t8
    t47 = t21 * t23
    t51 = t21 * t38
    t52 = t7 * t2
    t56 = t10 * t1
    t57 = t56 * t8
    t60 = t23 * t56
    t61 = t12 ** 2
    t65 = t21 * t60
    t66 = t61 ** 2
    t70 = t60 * t27
    t73 = t8 * t23
    t74 = t12 * t27
    t75 = t74 * t21
    t78 = t56 * t13
    t79 = t52 * b
    t83 = t9 * t15
    t84 = t61 * t12
    t85 = t84 * t21
    t92 = t21 * t24
    t93 = t27 * t7

    t99 = dble(75 * t11 * t16) + 0.77D2 * t22 * t25 * t27 - 0.176D3 * &
         t33 * t35 - 0.48D2 * t22 * t39 - 0.355D3 * t42 * t43 * t12 + &
         0.5D1 * t47 * t26 * t8 + 0.12D2 * t51 * t27 * t52 - 0.120D3 *&
         t22 * t57 + 0.21D2 * t22 * t60 * t61 + 0.5D1 * t65 * t66 *   &
         t2 + 0.21D2 * t22 * t70 + 0.75D2 * t73 * t75 + 0.920D3 *     &
         t78 * t79 * t31 - 0.8D1 * t83 * t85 * t10 + 0.3D1 * t65 *    &
         t84 * t2 + 0.3D1 * t92 * t93 - 0.9D1 * t22 * t60 * t26

    t100 = t84 * t15
    t103 = t74 * t2
    t106 = t26 * t52
    t108 = t24 * a
    t109 = t27 * b
    t114 = b * t10
    t118 = t84 * t7
    t125 = t23 ** 2
    t126 = t21 * t125
    t127 = t61 * t27
    t130 = t21 * t56
    t134 = t8 * t7
    t135 = t134 * t15
    t136 = t34 * t1
    t139 = t134 * t1
    t145 = t61 * t52
    t155 = t21 * t8
    t156 = t23 * t27
    t161 = t134 * t31
    t162 = t12 * t21

    t165 = -0.8D1 * t65 * t100 + 0.45D2 * t65 * t103 + t51 * t106 +   &
         0.69D2 * t108 * t109 * t7 - 0.890D3 * t8 * a * t114 * t31 +  &
         0.189D3 * t92 * t118 * t26 + 0.30D2 * t47 * t84 * t8 +       &
         0.70D2 * t126 * t127 + 0.15D2 * t130 * t84 * t9 + 0.149D3 *  &
         t135 * t136 - 0.5D1 * t139 * dble(t16) + 0.30D2 * t51 * t84 *&
         t52 + 0.15D2 * t51 * t145 + 0.225D3 * t47 * t61 * t8 * t26 - &
         0.151D3 * t42 * t43 * t26 + 0.15D2 * t155 * t156 - 0.9D1 *   &
         t22 * t25 - 0.10D2 * t161 * t162

    t168 = t26 * b
    t169 = t27 * t168
    t172 = t8 ** 2
    t175 = t60 * t12
    t178 = t38 * t61
    t179 = t178 * t7
    t182 = t12 * t52
    t186 = t22 * t24
    t192 = t9 * t31
    t199 = t1 * t26 * t21
    t202 = t21 * t9
    t203 = t56 * t61
    t206 = t52 * t38
    t207 = a * t109
    t210 = t7 * t24
    t214 = t13 * t109
    t217 = t13 * t168
    t220 = t31 * t38
    t221 = t14 * t2
    t224 = t61 * t13
    t225 = t224 * b
    t228 = t9 * t56
    t229 = a * t168

    t232 = 0.8D1 * t125 * a * t169 + t172 * t12 * t21 - 0.9D1 * t22 * &
         t175 + 0.205D3 * t22 * t179 + 0.195D3 * t51 * t182 * t27 -   &
         0.440D3 * t186 * t103 + 0.171D3 * t22 * t57 * t26 - 0.272D3 *&
         t192 * t136 + 0.20D2 * t24 * t27 * t42 + 0.14D2 * t135 *     &
         t199 + 0.30D2 * t202 * t203 + 0.84D2 * t206 * t207 + 0.15D2 *&
         t210 * a * t169 + 0.238D3 * t210 * t214 + 0.330D3 * t73 *    &
         t217 + 0.420D3 * t220 * t221 + 0.44D2 * t73 * t225 + 0.75D2 *&
         t228 * t229

    t233 = t8 * t32
    t238 = t38 * t26
    t239 = t21 * t32
    t244 = t61 * a
    t246 = b * t23
    t249 = t56 * t26
    t262 = t24 * t244
    t263 = t7 * b
    t266 = t12 * t8
    t270 = t15 * t24
    t271 = t229 * t2
    t275 = b * t56
    t281 = t57 * t61
    t283 = t26 * t15 * t21
    t286 = t38 * t13
    t289 = t106 * t12
    t292 = t60 * t13
    t293 = t2 * t109

    t296 = -0.224D3 * t233 * t136 + 0.33D2 * t73 * t207 - 0.16D2 *    &
         t238 * t239 + 0.18D2 * t239 * t9 + 0.198D3 * t8 * t244 *     &
         t246 - 0.144D3 * t249 * t239 * t7 + 0.192D3 * t52 * t244 *   &
         b * t38 + 0.9D1 * t228 * t225 + 0.86D2 * t38 * t224 * t79 +  &
         0.93D2 * t262 * t263 + 0.135D3 * t47 * t266 * t26 + 0.377D3 *&
         t270 * t271 + 0.138D3 * t9 * t13 * t275 + 0.132D3 * t8 *     &
         t13 * t246 - 0.160D3 * t281 * t283 + 0.63D2 * t286 * t79 +   &
         0.81D2 * t51 * t289 + 0.203D3 * t292 * t293

    t299 = t7 * t168
    t302 = t168 * t2
    t305 = t60 * t244
    t306 = b * t2
    t309 = t23 * a
    t310 = b * t8
    t313 = t8 * t15
    t315 = t56 * t27 * t21
    t318 = t61 * t21
    t319 = t318 * t1
    t325 = t24 * t13
    t328 = t38 * t12
    t332 = t56 * t12
    t339 = t84 * t26
    t340 = t339 * t21
    t343 = t38 * a
    t348 = t2 * a

    t360 = 0.399D3 * t262 * t299 + 0.60D2 * t292 * t302 + 0.18D2 *    &
         t305 * t306 + 0.11D2 * t309 * t310 - 0.2D1 * t313 * t315 +   &
         0.20D2 * t192 * t319 + 0.18D2 * t60 * a * t293 + 0.12D2 *    &
         t325 * t263 - 0.265D3 * t42 * t328 * t2 + 0.10D2 * t202 *    &
         t332 - 0.80D2 * t1 * t32 * t266 * t21 + 0.133D3 * t206 *     &
         t340 + 0.2D1 * t343 * t79 + 0.12D2 * t108 * t299 + 0.23D2 *  &
         t348 * t169 * t60 + 0.82D2 * t22 * dble(t11) * t26 -         &
         0.600D3 * t52 * t15 * t61 * t47 * t26

    t361 = t60 * t15
    t364 = t24 * t31
    t367 = t23 * t61
    t372 = t61 * t26
    t378 = t31 * t23
    t379 = t14 * t7
    t387 = t66 * t21
    t392 = t61 * t7
    t398 = t27 * t26
    t402 = t134 * t10
    t408 = t27 ** 2

    t412 = 0.84D2 * t361 * t14 - 0.102D3 * t364 * t34 + 0.30D2 *      &
         t155 * t367 + 0.35D2 * t73 * t340 + 0.60D2 * t228 * t372 *   &
         t21 + 0.84D2 * t361 * t229 + 0.880D3 * t378 * t379 +         &
         0.119D3 * t65 * t339 * t2 + 0.28D2 * t126 * t339 + t228 *    &
         t387 + 0.5D1 * t73 * t387 + t51 * t182 + 0.3D1 * t92 * t392 +&
         0.6D1 * t228 * t27 * t21 + 0.6D1 * t206 * t398 * t21 +       &
         0.3D1 * t402 * t85 - 0.18D2 * t361 * t34 + 0.2D1 * t2 * t60 *&
         t408 * t21

    t414 = t398 * t15
    t418 = t8 * t52
    t419 = t418 * t1
    t423 = t1 * t9
    t442 = t7 * t12 * t26
    t449 = t23 * t52
    t450 = t449 * t12
    t453 = t244 * b
    t454 = t453 * t15
    t457 = t38 * t32
    t467 = t418 * t12

    t475 = -0.24D2 * t92 * t414 * t2 + 0.2D1 * t419 * t26 * t21 +     &
         0.111D3 * t42 * t423 + 0.5D1 * t47 * t266 + 0.104D3 * t22 *  &
         t24 * t61 * t2 + 0.90D2 * t239 * t1 * t8 + 0.10D2 * t92 *    &
         t66 * t7 + 0.20D2 * t364 * t318 + 0.864D3 * t22 * t38 *      &
         t442 + 0.99D2 * t130 * t12 * t9 * t26 + 0.125D3 * t22 *      &
         t450 - 0.56D2 * dble(t11) * t454 - 0.16D2 * t457 * t162 +    &
         0.15D2 * t134 * t61 * t21 * t10 + 0.205D3 * t22 * t57 * t12 +&
         0.7D1 * t467 * t22 + 0.15D2 * t92 * t118 + 0.10D2 * t51 *    &
         t66 * t52

    t481 = t21 * t1
    t491 = t56 * t52
    t495 = t398 * t12
    t501 = t38 * t2
    t506 = t26 * t10
    t507 = t506 * t21
    t510 = t9 * a
    t516 = t8 * t31
    t522 = t134 * a

    t529 = -0.8D1 * t65 * t414 + 0.180D3 * t239 * t10 * t52 + 0.5D1 * &
         t467 * t481 - 0.528D3 * t23 * t244 * t79 * t15 + 0.3D1 *     &
         t418 * t61 * t481 + 0.510D3 * t42 * t491 - t135 * t319 +     &
         0.28D2 * t126 * t495 + 0.3D1 * t65 * t398 * t2 - 0.244D3 *   &
         t42 * t501 * t26 - 0.9D1 * t83 * t12 * t507 + 0.24D2 * t510 *&
         t275 + 0.9D1 * t92 * t398 * t7 + 0.480D3 * t516 * t14 * t10 +&
         0.80D2 * t364 * t14 + 0.26D2 * t522 * t114 - 0.48D2 * t361 * &
         t207 + 0.80D2 * t364 * t229

    t562 = t24 * t26

    t577 = -0.160D3 * t361 * t217 - 0.48D2 * t361 * t453 + 0.245D3 *  &
         t305 * t302 + 0.84D2 * t24 * t224 * t263 + 0.41D2 * t60 *    &
         t224 * t306 + 0.126D3 * t22 * t175 * t26 - 0.32D2 * t457 *   &
         t34 + 0.330D3 * t42 * t43 - 0.80D2 * t33 * t2 * t21 * t12 -  &
         0.184D3 * t270 * t348 * t109 + 0.45D2 * t65 * t372 * t2 -    &
         0.51D2 * t42 * t562 - 0.248D3 * t270 * t453 * t2 + 0.95D2 *  &
         t22 * t281 + 0.89D2 * t22 * t39 * t27 + 0.270D3 * t325 *     &
         t299 + 0.91D2 * t206 * t214

    t578 = t244 * t168
    t598 = t168 * t52
    t601 = t127 * t21
    t604 = t299 * t15
    t617 = t56 * t32
    t622 = t24 * t12

    t631 = 0.77D2 * t73 * t578 + 0.287D3 * t206 * t578 + 0.14D2 *     &
         t418 * a * b * t1 + 0.21D2 * t522 * t168 * t10 + 0.152D3 *   &
         t22 * t449 * t26 + 0.36D2 * t42 * t24 + 0.99D2 * t309 *      &
         t168 * t8 + 0.57D2 * t343 * t598 + 0.105D3 * t206 * t601 +   &
         0.620D3 * t343 * t604 + 0.450D3 * t286 * t598 + 0.438D3 *    &
         t309 * t598 * t15 + 0.100D3 * t192 * t14 * t1 + 0.102D3 *    &
         t228 * t453 - 0.160D3 * t617 * t7 * t21 * t12 + 0.165D3 *    &
         t622 * t93 * t21 + 0.200D3 * t42 * t203 * t52 + 0.15D2 *     &
         t419 * t14

    t645 = t217 * t15
    t662 = t23 * t7
    t666 = t15 * t38
    t667 = t34 * t7
    t676 = t21 * t134
    t679 = t9 * t32

    t682 = 0.72D2 * t402 * t14 + 0.90D2 * t228 * t217 + 0.21D2 *      &
         t402 * t453 + 0.56D2 * t125 * t13 * t109 + 0.195D3 * t92 *   &
         t392 * t26 - 0.880D3 * t449 * t645 - 0.30D2 * t161 * t34 +   &
         0.3D1 * t172 * a * b + t126 * t408 + 0.18D2 * t239 * t38 -   &
         0.3D1 * t21 * t418 * t15 + 0.8D1 * t125 * t224 * b -         &
         0.560D3 * t42 * t662 * t12 + 0.29D2 * t666 * t667 + 0.53D2 * &
         t22 * t139 * t12 - 0.101D3 * t42 * t423 * t12 + 0.7D1 *      &
         t676 * t506 - 0.48D2 * t679 * t34

    t693 = t10 * t12
    t720 = t10 * t32
    t722 = t52 * a * b

    t733 = 0.21D2 * t418 * t15 * t34 + 0.56D2 * t125 * t244 * t168 +  &
         t126 * t66 - 0.512D3 * t666 * t453 * t7 + 0.10D2 * t676 *    &
         t693 - 0.18D2 * t22 * t562 * t2 - 0.560D3 * t220 * t35 -     &
         0.40D2 * t313 * t85 * t56 + 0.27D2 * t134 * t12 * t507 -     &
         0.24D2 * t22 * t139 - 0.51D2 * t42 * t622 + 0.15D2 * t42 *   &
         t134 + 0.77D2 * t65 * t495 * t2 - 0.80D2 * t23 * t26 * t239 *&
         t2 - 0.416D3 * t720 * t722 - 0.446D3 * t42 * t662 * t26 -    &
         0.112D3 * t52 * t32 * t507 - 0.1250D4 * t378 * t667

    t744 = t15 * t23
    t751 = t162 * t26

    t784 = 0.80D2 * t42 * t38 * t27 * t2 + 0.543D3 * t186 * t12 * t2 *&
         t26 + 0.317D3 * t744 * t722 + 0.90D2 * t239 * t23 * t2 +     &
         0.540D3 * t220 * t2 * t751 - 0.54D2 * t270 * t35 - 0.240D3 * &
         t57 * t645 + 0.431D3 * t270 * t221 + 0.120D3 * t562 * t42 *  &
         t12 + 0.280D3 * t210 * t601 - 0.160D3 * t720 * t52 * t21 *   &
         t12 + 0.100D3 * t42 * t178 * t2 + 0.886D3 * t744 * t14 *     &
         t52 - 0.20D2 * t192 * t199 - 0.384D3 * t42 * t491 * t26 -    &
         0.840D3 * t179 * t283 - 0.16D2 * t679 * t162

    t800 = t207 * t15
    t810 = t52 * t31

    t841 = 0.31D2 * t22 * t449 * t27 - 0.80D2 * t22 * t23 * t84 *     &
         t52 - 0.1200D4 * t286 * t604 + 0.180D3 * t516 * t12 * t507 + &
         0.40D2 * t22 * t238 * t7 - 0.224D3 * t39 * t800 - 0.40D2 *   &
         t92 * t100 * t2 + 0.138D3 * t22 * t8 * t332 * t26 + 0.660D3 *&
         t810 * t12 * t130 * t26 + 0.18D2 * t92 * t442 + 0.434D3 *    &
         t78 * t310 * t15 - 0.720D3 * t270 * t217 * t2 + 0.245D3 *    &
         t65 * t127 * t2 - 0.520D3 * t270 * t61 * t26 * t2 * t21 +    &
         0.435D3 * t42 * t662 - 0.1440D4 * t31 * t56 * t722 +         &
         0.879D3 * t666 * t379 + 0.404D3 * t510 * t114 * t15

    t858 = t229 * t31
    t888 = t229 * t15

    t894 = -0.384D3 * t617 * t667 - 0.120D3 * t22 * t70 * t12 +       &
         0.315D3 * t51 * t145 * t26 - 0.75D2 * t22 * dble(t11) +      &
         0.195D3 * t42 * t501 - 0.27D2 * t22 * t622 * t2 + 0.500D3 *  &
         t491 * t858 + 0.900D3 * t378 * t7 * t751 + 0.151D3 * t22 *   &
         dble(t11) * t12 - 0.88D2 * t449 * t800 + 0.594D3 * t22 *     &
         t23 * t289 - 0.610D3 * t42 * t491 * t12 - 0.272D3 * t57 *    &
         t454 + 0.180D3 * t239 * t56 * t7 + 0.100D3 * t7 * t31 *      &
         t156 * t21 - 0.200D3 * t450 * t27 * t15 * t21 + 0.104D3 *    &
         t57 * t888 + 0.200D3 * t22 * t449 * t61

    t922 = t7 * t15

    t947 = 0.140D3 * t43 * t858 + 0.380D3 * t220 * t271 - 0.32D2 *    &
         t233 * t199 + 0.49D2 * t210 * t495 * t21 + 0.100D3 * t516 *  &
         t318 * t10 + 0.40D2 * t810 * t315 + 0.9D1 * t202 * t249 +    &
         0.16D2 * t22 * dble(t11) * t61 - 0.105D3 * t22 * t449 -      &
         0.7D1 * dble(t11) * t888 + 0.528D3 * t15 * t56 * t34 * t8 -  &
         0.520D3 * t922 * t38 * t75 + 0.660D3 * t378 * t7 * a * t168 +&
         0.200D3 * t42 * t367 * t7 - 0.80D2 * t22 * t38 * t84 * t7 -  &
         0.120D3 * t65 * t372 * t15 + 0.7D1 * t22 * t328 * t7 -       &
         0.16D2 * t922 * t38 * t398 * t21

    t963 = t693 + t1 * t12 * t2 + 0.2D1 * t10 * a * t21 * b + t506 +  &
         t2 * t1 + t7 + t15 * t1 + t15 * t2

    t964 = t963 ** 2
    t965 = t964 ** 2
    t966 = t965 ** 2
    t971 = sqrt(t963 / t3)

    Vy = (-0.3D1 * t4 * t3 * x * (t99 + t165 + t232 + t296 + t360 +    &
         t412 + t475 + t529 + t577 + t631 + t682 + t733 + t784 +      &
         t841 + t894 + t947) / t21 / t966 / t971)

  end subroutine get_GradB2CrossB_y
  !========================================================================
  subroutine get_GradB2CrossB_z(x, y, z, Vz)

    implicit none

    real, intent(IN) :: x, y, z
    real, intent(OUT):: Vz
    ! Local variables used for optimization
    real :: t1,   t2,   t3,   t4,   t5,   t11,  t12,  t13,  t14,  t15
    real :: t16,  t17,  t18,  t21,  t22,  t23,  t26,  t27,  t28,  t33
    real :: t34,  t36,  t39,  t40,  t45,  t48,  t49,  t54,  t70,  t74
    real :: t75,  t76,  t79,  t82,  t83,  t84,  t85,  t88,  t91,  t92
    real :: t93,  t96,  t99,  t102, t103, t108, t113, t114, t118, t121
    real :: t122, t126, t129, t130, t133, t139, t140, t143, t147, t150
    real :: t152, t153, t158, t164, t168, t175, t178, t179, t180, t187
    real :: t204, t207, t212, t219, t220, t226, t235, t238, t248, t255
    real :: t265, t270, t272, t275, t276, t279, t281, t290, t311, t314
    real :: t322, t330, t334, t342, t350, t366, t368, t379, t383, t392
    real :: t417, t466, t478, t479, t480, t481, t485
    real :: a, b
    !------------------------------------------------------------------------
    a = StretchingFactorA
    b = StretchingFactorB
    
    !\
    ! Calculations are done by Maple using CodeGeneration with optimize flag.
    !/

    t1 = x ** 2
    t2 = y ** 2
    t3 = t1 + t2
    t4 = t3 ** 2
    t5 = t4 ** 2
    t11 = sqrt(t3 / t1)
    t12 = t1 ** 2
    t13 = t12 ** 2
    t14 = t11 * t13
    t15 = a ** 2
    t16 = t15 ** 2
    t17 = t2 ** 2
    t18 = t16 * t17
    t21 = t13 * t1
    t22 = t21 * t2
    t23 = a * b
    t26 = z ** 2
    t27 = t13 * t26
    t28 = t15 * a
    t33 = t17 ** 2
    t34 = t33 * t2
    t36 = t11 * t26
    t39 = t11 * t21
    t40 = t16 * t15
    t45 = t11 * t1
    t48 = b ** 2
    t49 = t48 ** 2
    t54 = t48 * b
    t70 = t12 * a
    t74 = t13 * t12
    t75 = t11 * t74
    t76 = t16 * t48
    t79 = t28 * t54
    t82 = t17 * t2
    t83 = t12 * t1
    t84 = t82 * t83
    t85 = a * t54
    t88 = t17 * t13
    t91 = 0.2D1 * t14 * t18 - 0.4D1 * t22 * t23 - 0.120D3 * t27 * t2 *&
         t28 * b + 0.9D1 * t34 * t15 * t36 + 0.4D1 * t39 * t40 * t2 + &
         0.2D1 * t34 * t16 * t45 + 0.7D1 * t14 * t49 * t17 + 0.2D1 *  &
         t21 * a * t54 * t2 + 0.10D2 * t34 * t28 * b * t1 + 0.14D2 *  &
         t33 * a * t54 * t12 + 0.27D2 * t34 * a * b * t26 + 0.2D1 *   &
         t70 * b * t33 + 0.20D2 * t75 * t76 + 0.90D2 * t22 * t79 +    &
         0.38D2 * t84 * t85 + 0.90D2 * t88 * t79

    t92 = t49 * b
    t93 = a * t92
    t96 = t28 * b
    t99 = t33 * t12
    t102 = t16 * a
    t103 = t102 * b
    t108 = t21 * t26
    t113 = t26 ** 2
    t114 = t13 * t113
    t118 = t2 * b
    t121 = t11 * t33
    t122 = t12 * t48
    t126 = t17 * b
    t129 = t11 * t34
    t130 = t1 * t15
    t133 = t49 * t15
    t139 = t11 * t17
    t140 = t13 * t15
    t143 = t11 * t83
    t147 = t12 * t15
    
    t150 = 0.22D2 * t22 * t93 + 0.44D2 * t84 * t96 + 0.36D2 * t99 *   &
         t96 + 0.28D2 * t84 * t103 + 0.42D2 * t88 * t103 - 0.30D2 *   &
         t108 * t96 - 0.42D2 * t108 * t85 + 0.24D2 * t114 * t23 +     &
         0.28D2 * t21 * t102 * t118 + 0.4D1 * t121 * t122 + 0.16D2 *  &
         t13 * t28 * t126 + 0.2D1 * t129 * t130 + 0.25D2 * t75 *      &
         t133 - 0.12D2 * t39 * t49 * t26 - 0.7D1 * t139 * t140 +      &
         0.8D1 * t143 * t16 * t82 - 0.2D1 * t121 * t147

    t152 = t11 * t82
    t153 = t12 * t26
    t158 = t13 * t2
    t164 = t11 * t113
    t168 = t13 * a
    t175 = t83 * t26
    t178 = t83 * t113
    t179 = t2 * a
    t180 = t179 * b
    t187 = t33 * t113
    t204 = t16 * t2
    
    t207 = -0.114D3 * t152 * t153 + 0.57D2 * t108 * t23 - 0.69D2 *    &
         t36 * t158 + 0.2D1 * t39 * t2 * t49 - 0.32D2 * t164 * t82 *  &
         t1 + 0.30D2 * t168 * t54 * t17 + 0.60D2 * t14 * t18 * t48 -  &
         0.126D3 * t139 * t175 + 0.96D2 * t178 * t180 + 0.390D3 *     &
         t153 * t82 * a * b + 0.24D2 * t187 * t23 + 0.30D2 * t84 *    &
         t79 + 0.36D2 * t36 * t21 * t48 - 0.32D2 * t164 * t83 * t2 -  &
         0.48D2 * t164 * t12 * t17 + 0.21D2 * t36 * t21 * t15 -       &
         0.2D1 * t39 * t204

    t212 = t15 * t11
    t219 = t34 * t1
    t220 = t48 * t11
    t226 = t49 * t48
    t235 = t2 * t48
    t238 = t2 * t15
    t248 = t15 * t48
    
    t255 = 0.7D1 * t99 * t103 + 0.11D2 * t88 * t93 + 0.8D1 * t187 *   &
         t212 + 0.8D1 * t114 * t212 + t99 * t40 * t11 + 0.2D1 * t219 *&
         t220 + 0.4D1 * t84 * t49 * t11 + 0.2D1 * t22 * t226 * t11 -  &
         0.6D1 * t74 * t48 * t212 + 0.16D2 * t114 * t220 - 0.2D1 *    &
         t39 * t235 - 0.2D1 * t39 * t238 - 0.126D3 * t27 * t179 *     &
         t54 - 0.180D3 * t175 * t17 * t28 * b + 0.18D2 * t99 * t248 * &
         t11 - t14 * t17 - 0.15D2 * t108 * t11

    t265 = t33 * t1
    t270 = t33 * t26
    t272 = t1 * t48 * t11
    t275 = t17 * t83
    t276 = t85 * t26
    t279 = t12 * t113
    t281 = t17 * a * b
    t290 = t82 * t113
    t311 = t147 * t82
    
    t314 = -t74 * t16 * t11 + 0.11D2 * t74 * a * t92 - 0.9D1 * t129 * &
         t26 - 0.6D1 * t265 * t16 * t11 * t26 + 0.18D2 * t270 * t272 -&
         0.126D3 * t275 * t276 + 0.144D3 * t279 * t281 + 0.50D2 *     &
         t39 * t238 * t49 - 0.54D2 * t39 * t248 * t26 + 0.32D2 *      &
         t290 * t45 * t15 + 0.8D1 * t219 * t23 + 0.60D2 * t39 * t204 *&
         t48 + 0.32D2 * t178 * t2 * t11 * t15 - 0.24D2 * t14 * t204 * &
         t26 + 0.93D2 * t36 * t140 * t2 + 0.255D3 * t27 * t180 +      &
         0.138D3 * t36 * t311

    t322 = t1 * a * b
    t330 = t26 * t1
    t334 = t11 * t12
    t342 = t74 * t28
    t350 = t33 * t17
    
    t366 = -0.54D2 * t311 * t220 * t26 + 0.6D1 * t14 * t40 * t17 +    &
         0.165D3 * t270 * t322 + 0.48D2 * t2 * t113 * t83 * t48 *     &
         t11 - 0.51D2 * t121 * t330 + 0.48D2 * t17 * t113 * t334 *    &
         t48 + 0.450D3 * t175 * t281 - t74 * t49 * t11 - 0.4D1 *      &
         t342 * b - 0.4D1 * t129 * t1 + 0.2D1 * t75 * t226 + t75 *    &
         t40 + t350 * t15 * t11 + 0.3D1 * t350 * a * b - 0.8D1 *      &
         t164 * t13 - 0.12D2 * t17 * t26 * t83 * t49 * t11 + 0.126D3 *&
         t14 * t235 * t26

    t368 = t15 * t82
    t379 = t83 * t15
    t383 = t82 * t12
    t392 = t96 * t26
    
    t417 = -0.8D1 * t143 * t368 + 0.48D2 * t279 * t139 * t15 - t11 *  &
         t350 - 0.162D3 * t36 * t13 * t238 * t48 + 0.162D3 * t36 *    &
         t379 * t17 - 0.24D2 * t36 * t383 * t16 - 0.6D1 * t21 * t28 * &
         t118 + 0.16D2 * t290 * t272 - 0.120D3 * t383 * t392 +        &
         0.48D2 * t143 * t368 * t48 + 0.96D2 * t290 * t322 - 0.30D2 * &
         t265 * t392 + 0.90D2 * t36 * t383 * t48 - 0.6D1 * t39 * t16 *&
         t26 + 0.4D1 * t143 * t40 * t82 - 0.4D1 * t14 * t48 * t17 +   &
         0.7D1 * t334 * t16 * t33

    t466 = 0.25D2 * t88 * t133 * t11 - 0.36D2 * t143 * t18 * t26 -    &
         0.12D2 * t83 * a * b * t82 - 0.13D2 * t168 * t126 + 0.36D2 * &
         t14 * t15 * t17 * t48 - 0.24D2 * t36 * t158 * t49 - 0.162D3 *&
         t36 * t17 * t379 * t48 + 0.57D2 * t36 * t265 * t15 - 0.42D2 *&
         t383 * t276 + 0.162D3 * t36 * t275 * t48 + 0.20D2 * t84 *    &
         t76 * t11 - 0.6D1 * t121 * t12 + 0.30D2 * t342 * t54 -       &
         0.4D1 * t152 * t83 - 0.4D1 * t74 * t54 * a - 0.8D1 * t164 *  &
         t33 + 0.7D1 * t74 * t102 * b

    t478 = t147 + t130 * t2 + 0.2D1 * t70 * t11 * b + t122 + t2 * t1 +&
         t17 + t330 + t26 * t2

    t479 = t478 ** 2
    t480 = t479 ** 2
    t481 = t480 ** 2
    t485 = sqrt(t478 / t3)
    
    Vz =(-0.9D1 * t5 * x * z * y * (t91 + t150 + t207 + t255 + t314 + &
         t366 + t417 + t466) / t11 / t481 / t485)

  end subroutine get_GradB2CrossB_z
  !========================================================================
  end module get_gradB_components
